<!DOCTYPE HTML>
<html>
 <head>
  <title> </title>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link href="/template/admin/assets/css/dpl-min.css" rel="stylesheet" type="text/css" />
    <link href="/template/admin/assets/css/bui-min.css" rel="stylesheet" type="text/css" />
    <link href="/template/admin/assets/css/page-min.css" rel="stylesheet" type="text/css" />   <!-- 下面的样式，仅是为了显示代码，而不应该在项目中使用-->
   <link href="/template/admin/assets/css/prettify.css" rel="stylesheet" type="text/css" />
   <style type="text/css">
      input{
        min-width: 200px;
        padding: 0 10px;
      }
      .container{
        width: 80%;
        margin: 0 auto;
      }
      .text{
        margin-top: 30px;
      }
      .text .title{
        margin-bottom: 30px;
      }
      .text .title input{
        border: 1px solid #3F5694;
        min-height: 30px;
      }
      .text .content{
        margin-bottom: 30px;
      }
      .text .content input{
        border: 1px solid #3F5694;
        min-width: 400px;
        min-height: 100px;
      }
      .btn button{
          border: none;
          width: 60px;
          height: 30px;
          background: #00AD19;
          color: #fff;
          margin-left: 30%;
      }
   </style>
 </head>
 <body>

    <form action="/admin/article/add" method="post" >
        <div class="container">
          <div class="nav">
              <span>一级菜单：</span>
              <select name="first_level_menu" id="first_level_menu" onchange="changeSelect(this.selectedIndex)">
                  <eg name="menu" value="0" >
                      <option value="0">请选择一级菜单</option>
                        <foreach name="menu" item="m" >
                            <option value="$m.id">{$m.name}</option>
                        </foreach>
                  </eg>
              </select>
              <span>二级菜单：</span>
              <select name="cat_id" id="two_level_menu"></select>
          </div>
          <div class="text">
              <div class="title">
                  <span>标题：</span>
                  <input type="text" name="title" />
              </div>
              <div class="content">
                  <span>内容：</span>
                  <input type="text" name="content"/>
              </div>
          </div>
          <div class="btn">
              <button type="submit">提交</button>
          </div>
        </div>
    </form>

    <script src="http://g.tbcdn.cn/fi/bui/jquery-1.8.1.min.js"></script>

  <script>

      function  menuObj(pid=0){
          var result;
          $.ajax({
              type:'get',
              url:'/admin/navListLevel',
              dataType:'json',
              data:{pid:pid},
              async:false,
              success:function(data){
                  result = data;
              }
          });
          return result;
      }



      var coordinatesFirst = menuObj();

      // console.log(coordinatesFirst);

      var enumObjArr = new Array();

      // if(coordinatesFirst || coordinatesFirst.length) {//初始化页面，把所有坐标列一个列表
      //     $.each(coordinatesFirst, function(index,term) {
      //         index++;
      //         if(term.id) {
      //             enumObjArr[index] = [term.id,term.name];
      //          //  enumObjArr[index][term.id] = term.name;
      //           //  enumObjArr[term.id] = term.id;
      //         }
      //     })
      // }

      for (var i=0;i<coordinatesFirst.length;i++) {
          enumObjArr[i] = [coordinatesFirst[i]['id'],coordinatesFirst[i]['name']];
      }



      enumObjArr[0] = [0,"请选择一级菜单"];


    var arr_province = enumObjArr;// ["请选择一级菜单","走进锐堃","新闻中心","集团产业","社会责任","人力资源"];
    var arr_city = [
                      ["请选择二级菜单"],
                    //  ['走进锐堃',"董事长致辞","集团介绍","发展战略","研发创新","企业文化","联系我们"],
                    //  ['锐堃动态','新闻聚焦','循环经济', '在线读报','视频中心'],
                    // ['国骥网络', '锐享汽贸', '圣手医学', '锐享生物', '积分交易所', '金映农业', '锐族实业', '易金融'],
                    //  ['责任体系', '社会公益', '光彩事业'],
                    //  ['人才理念', '人才发展', '社会招聘', '招聘声明']
                ];
    //网页加载完成，初始化菜单
     window.onload = init;//传入函数地址
     function init(){
         //首先获取对象
         var first_level_menu = document.getElementById("first_level_menu");
         var two_level_menu = document.getElementById("two_level_menu");
 
         //指定省份中<option>标记的个数
            first_level_menu.length = arr_province.length;
 
         //循环将数组中的数据写入<option>标记中
         for(var i=0;i<arr_province.length;i++){
            first_level_menu.options[i].text = arr_province[i][1];
            first_level_menu.options[i].value = arr_province[i][0];
         }
 
         //修改省份列表的默认选择项
         var index = 0;
         first_level_menu.selectedIndex = index;
 
         //指定城市中<option>标记的个数
            two_level_menu.length = arr_city[index].length;

 
         //循环将数组中的数据写入<option>标记中
         for (var j = 0; j<arr_city[index].length;j++) {
            two_level_menu.options[j].text = arr_city[index][j];
            two_level_menu.options[j].value = 0;
         }
     }
 
     function  changeSelect(index){


         var options = '<option value="0">请选择二级菜单</option>';

         if(!index){
             $("#two_level_menu").html(options);
             return false;
         }

         var arr_city = menuObj(index);


         //选择对象
         var two_level_menu = document.getElementById("two_level_menu");
         //修改省份列表的选择项
         first_level_menu.selectedIndex = index;

         //指定菜单中<option>标记的个数

         //循环将数组中的数据写入<option>标记中
         for (var j = 0; j<arr_city.length;j++) {
             options += '<option value="'+ arr_city[j]['id'] + '">'+ arr_city[j]['name'] + '</option>';
             //two_level_menu.options[j].text = arr_city[j]['name'];
         // two_level_menu.options[j].text = arr_city[index][j];
          // two_level_menu.options[j].value = arr_city[index][j];
         }

         $("#two_level_menu").html(options);
     }            
  </script>  

<body>
</html>  