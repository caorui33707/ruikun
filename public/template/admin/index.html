<!DOCTYPE HTML>
<html>
 <head>
  <title>管理后台</title>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <link href="__ASS__/css/dpl-min.css" rel="stylesheet" type="text/css" />
  <link href="__ASS__/css/bui-min.css" rel="stylesheet" type="text/css" />
   <link href="__ASS__/css/main-min.css" rel="stylesheet" type="text/css" />
     <link href="__ASS__/css/login.css" rel="stylesheet" type="text/css" />
 </head>
 <body>

  <div class="header">
    
      <div class="dl-title">
        <a href="http://www.builive.com" title="文档库地址" target="_blank"><!-- 仅仅为了提供文档的快速入口，项目中请删除链接 -->
          <span class="lp-title-port">BUI</span><span class="dl-title-text">后端设置</span>
        </a>
      </div>

    <!--<div class="dl-log">-->
        <!--&lt;!&ndash;欢迎您，<span class="dl-log-user">**.**@alibaba-inc.com</span><a href="###" title="退出系统" class="dl-log-quit">[退出]</a><a href="http://http://www.builive.com/" title="文档库" class="dl-log-quit">文档库</a>&ndash;&gt;-->
    <!---->
    <!--</div>-->
      <div class="dl-log">
          <!--<span>[登录]</span>-->
          <if condition="$user_admin eq true">
              欢迎您，<span class="dl-log-user">{$user_admin.user}</span><a href="###" title="退出系统" class="dl-log-quit" onclick="return out()">[退出]</a>
            <else />
              <div class="login" style="display: block">
                  <div class="mask"></div>
                  <la class="log">
                      <h2>登录</h2>
                      <div><label for="">用户名：</label><input type="text" name="user" /></div>
                      <div><label for="">密码：</label><input type="text" name="passwd" /></div>
                      <button type="submit" onclick="returnSubmit()">登录</button>
                      <!--<span>x</span>-->
              </div>
          </if>
      </div>
      <!--<a href="http://http://www.builive.com/" title="文档库" class="dl-log-quit">文档库</a>-->
  </div>

  </div>
   <div class="content">
    <div class="dl-main-nav">
      <div class="dl-inform"><div class="dl-inform-title">贴心小秘书<s class="dl-inform-icon dl-up"></s></div></div>
      <ul id="J_Nav"  class="nav-list ks-clear">
        <li class="nav-item dl-selected"><div class="nav-item-inner nav-home">首页</div></li>
        <li class="nav-item"><div class="nav-item-inner nav-supplier">详情页</div></li>
        <li class="nav-item"><div class="nav-item-inner nav-order">表单页</div></li>
      </ul>
    </div>
    <ul id="J_NavContent" class="dl-tab-conten">

    </ul>
   </div>
  <script type="text/javascript" src="__ASS__/js/jquery-1.8.1.min.js"></script>
  <script type="text/javascript" src="__ASS__/js/bui.js"></script>
  <script type="text/javascript" src="__ASS__/js/config.js"></script>

  <script>
      // let ele = {
      //     span: document.querySelector(".dl-log > span"),
      //     x: document.querySelector(".login .log > span"),
      //     mask: document.querySelector(".login .mask"),
      //     login: document.querySelector(".login")
      // };
      // ele.span.addEventListener("click", function() {
      //     ele.login.style.cssText = "display: block;";
      // })
      // ele.x.addEventListener("click", function() {
      //     ele.login.style.cssText = "display: none;";
      // })
      // ele.mask.addEventListener("click", function() {
      //     ele.login.style.cssText = "display: none;";
      // })

    BUI.use('common/main',function(){
      var config = [{
          id:'menu', 
          homePage : 'menu-list',
          menu:[{
              text:'首页内容',
              items:[
                // {id:'code',text:'首页代码',href:'__MAIN__/code.html',closeable : false}

                {id:'menu-list',text:'导航列表',href:'__MAIN__/menu_list.html'},
                {id:'second-menu',text:'文章添加',href:'__MAIN__/second-menu.html'},
                // {id:'dyna-menu',text:'动态菜单',href:'__MAIN__/dyna-menu.html'},
              ]
            },{
              text:'权限',
              items:[
                {id:'operation',text:'添加用户',href:'__MAIN__/admin_add.html'},
                {id:'quick',text:'用户列表',href:'/admin/list'}
              ]
            },{
              text:'文件结构',
              items:[
                {id:'resource',text:'资源文件结构',href:'__MAIN__/resource.html'},
                {id:'loader',text:'引入JS方式',href:'__MAIN__/loader.html'}
              ]
            }]
          },{
            id:'detail',
            menu:[{
                text:'详情页面',
                items:[
                  {id:'code',text:'详情页面代码',href:'__ADMIN__/detail/code.html'},
                  {id:'example',text:'详情页面示例',href:'__ADMIN__/detail/example.html'},
                  {id:'introduce',text:'详情页面简介',href:'__ADMIN__/detail/introduce.html'}
                ]
              }]
          },{
          id:'form',
          menu:[{
              text:'表单页面',
              items:[
                  {id:'code',text:'表单代码',href:'__ADMIN__/form/code.html'},
                  {id:'example',text:'表单示例',href:'__ADMIN__/form/example.html'},
                  {id:'introduce',text:'表单简介',href:'__ADMIN__/form/introduce.html'},
                  {id:'valid',text:'表单基本验证',href:'__ADMIN__/form/basicValid.html'},
                  {id:'advalid',text:'表单复杂验证',href:'__ADMIN__/form/advalid.html'},
                  {id:'remote',text:'远程调用',href:'__ADMIN__/form/remote.html'},
                  {id:'group',text:'表单分组',href:'__ADMIN__/form/group.html'},
                  {id:'depends',text:'表单联动',href:'__ADMIN__/form/depends.html'}
              ]
          },{
              text:'成功失败页面',
              items:[
                  {id:'success',text:'成功页面',href:'__ADMIN__/form/success.html'},
                  {id:'fail',text:'失败页面',href:'__ADMIN__/form/fail.html'}

              ]
          },{
              text:'可编辑表格',
              items:[
                  {id:'grid',text:'可编辑表格',href:'__ADMIN__/form/grid.html'},
                  {id:'form-grid',text:'表单中的可编辑表格',href:'__ADMIN__/form/form-grid.html'},
                  {id:'dialog-grid',text:'使用弹出框',href:'__ADMIN__/form/dialog-grid.html'},
                  {id:'form-dialog-grid',text:'表单中使用弹出框',href:'__ADMIN__/form/form-dialog-grid.html'}
              ]
          }]
      }
          ];
      new PageUtil.MainPage({
        modulesConfig : config
      });
    });

      function returnSubmit(){

          $.ajax({
              type:'POST',
              url:'/admin/login',
              data:{user:$("input[name='user']").val(),passwd:$("input[name='passwd']").val()},
              dataType:'json',
              async:false,
              success:function(data){

                  if(data.status){
                      show(data.info);
                  }else{
                      show(data.info);
                      setTimeout('myrefresh()',3000); //指定1秒刷新一次
                  }
                  // result = data;
              }
          });
          //alert(22);
          //coordinates;
          return false;
      }

      function myrefresh()
      {
          window.location.reload();
      }

      function show (meg) {
          BUI.Message.Alert(meg,function(){
              //alert('确认');
          },'info');
      }

      function out() { //admin/out
          $.ajax({
              type:'get',
              url:'/admin/out',
              dataType:'json',
              async:false,
              success:function(data){

                  setTimeout('myrefresh()',1000); //指定1秒刷新一次
                  //data
                  // result = data;
              }
          });

          return false;
      }

  </script>
 </body>
</html>
